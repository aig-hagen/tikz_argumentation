\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{argumentation}[2023/11/05 Argumentation]
% Author:   Lars Bengel
% E-Mail:   lars.bengel@fernuni-hagen.de
% Version:  1.1
% Date:     2023/11/05
% License:  LaTeX Project Public License 1.3c

%%%%%%%%%%% Package Requirements %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{options}                        % For managing package options
\RequirePackage{tikz}                           % For drawing the argumentation frameworks
\usetikzlibrary{positioning}                    % For relative node positioning
\usetikzlibrary{arrows.meta}                    % For directed edges / attack arrows
\usetikzlibrary{arrows}                    % For directed edges / attack arrows
\usetikzlibrary{decorations.markings}           % For creating the support edge markings

\newcommand{\argstyle}[1]{#1}   % Defines the font style in which argument names are displayed


%%%%%%%%%% Package Options %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\options{
    /argumentation/.new family,
    /argumentation/argumentstyle/.new choice = {standard, retro},
    /argumentation/namestyle/.new choice = {italics, bold, bolditalics, monospace, normal},
    /argumentation/attackstyle/.new choice = {standard, retro},
    /argumentation/supportstyle/.new choice = {standard, dashed, double},
    /argumentation/@unknown/.new cmd 2 = \PackageWarning{argumentation}{Unknown option `#1'}
}
\options@ProcessOptions{/argumentation}

%%%%%%%%%% Processing options %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifcase\option{/argumentation/namestyle/@ord}
\renewcommand{\argstyle}[1]{\emph{#1}}
\or\renewcommand{\argstyle}[1]{\textbf{#1}}
\or\renewcommand{\argstyle}[1]{\emph{\textbf{#1}}}
\or\renewcommand{\argstyle}[1]{\texttt{#1}}
\or\relax
\fi

\ifcase\option{/argumentation/argumentstyle/@ord}
\tikzset{argument/.style={circle,draw=black,minimum size=0.7cm,inner sep=0,outer sep=0}}
\or\tikzset{argument/.style={circle, minimum size=0.75cm,draw=black,thick,fill=white,font=\Large, text centered, inner sep=0,outer sep=0}}
\fi

\ifcase\option{/argumentation/attackstyle/@ord}
\tikzset{>=stealth',
        attack/.style={->}
}
\or\tikzset{attack/.style={-{Stealth[scale=1.25]}}}
\fi

\ifcase\option{/argumentation/supportstyle/@ord}
\tikzset{support/.style = {postaction = {decorate,decoration={markings,mark=at position #1 with {\draw[-] (0,-0.1) -- (0.1,0.1);}}}}}
\or\tikzset{support/.style = {densely dashed}}
\or\tikzset{support/.style = {-{Classical TikZ Rightarrow},double}}
\fi

%%%%%%%%%% Package Content %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tikzset{ % Basic predefined tikz-styles
    % Self-Loop style
    every loop/.style={min distance=2mm,in=0,out=60,looseness=5},
    % Color shortcuts for labelled arguments and reduced arguments
    inactive/.style={draw=black!30, text=black!40,densely dashed},
    argin/.style={fill=green},
    argout/.style={fill=red},
    argundec/.style={fill=cyan},
    % Style for displaying AF name in Figure
    caption/.style={draw=none},
}

\newcommand{\setargumentstyle}[1]{\tikzset{argument/.style={#1}}}
\newcommand{\setattackstyle}[1]{\tikzset{attack/.style={#1}}}
\newcommand{\setloopstyle}[1]{\tikzset{every loop/.style={#1}}}

\newcommand{\adjustargumentstyle}[1]{\tikzset{argument/.append style={#1}}}
\newcommand{\adjustattackstyle}[1]{\tikzset{attack/.append style={#1}}}

\newcommand{\resetargumentstyle}{\setargumentstyle{circle, minimum size=0.75cm,draw=black,thick,fill=white,font=\Large, text centered, inner sep=0}}
\newcommand{\resetattackstyle}{\setattackstyle{-{Stealth[scale=1.25]}}}
\newcommand{\resetloopstyle}{\setloopstyle{min distance=2mm,in=0,out=60,looseness=5}}


\newenvironment{af}{
    \tikzpicture
}{%
    \endtikzpicture
}

\newenvironment{miniaf}[1][]{
    \tikzset{argument/.append style={font=\small, minimum size=0.5cm},
             attack/.append style={->},
    }
    \tikzpicture[node distance=0.5cm,#1]
}{%
    \endtikzpicture
}

% Creates a node displaying the name of the AF
\newcommand{\afname}[3][]{\node[caption,#1](#2){#3};}

% Creates an argument node
\newcommand{\argument}[3][]{\node[argument,#1](#2){\argstyle{#3}};}

% Creates an attack edge
\newcommand{\attack}[3][]{\path(#2) edge [attack,#1] (#3);}

% Creates a self-attack
\newcommand{\selfattack}[2][]{\path(#2) edge [attack,loop,#1] (#2);}

% Creates two symmetric attack edges between two arguments
\newcommand{\dualattack}[3][]{\path(#2) edge [attack, bend right,#1] (#3);\path(#3) edge [attack, bend right,#1] (#2);}

% Creates a support edge between two arguments
\newcommand{\support}[3][]{\path(#2) edge [attack,support=0.3,#1] (#3);}
